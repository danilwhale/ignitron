<Project>

    <Import Project="$(MSBuildThisFileDirectory)Ignitron.Common.References.props"/>

    <!-- 'DebugTest' and 'ReleaseTest': -->
    <!-- - these will copy the mod to the '<game directory>/mods'-->
    <PropertyGroup>
        <Configurations>$(Configurations);DebugTest;ReleaseTest</Configurations>
    </PropertyGroup>

    <PropertyGroup Condition="$(Configuration.EndsWith('Test'))">
        <CopyToGameDirectory>true</CopyToGameDirectory>
    </PropertyGroup>

    <PropertyGroup>
        <CopyToGameDirectory Condition="'$(CopyToGameDirectory)' == ''">false</CopyToGameDirectory>
    </PropertyGroup>

    <!-- copy the output directory contents to the '$(GameDirectory)/$(GameOutputDirectory)'. requires 'CopyToGameDirectory' to be set to 'true' -->
    <Target Name="CopyOutputDirToGame" AfterTargets="AfterBuild" Condition="$(CopyToGameDirectory)">
        <ItemGroup>
            <BuildFiles Include="$(OutDir)\**\*.*"/>
        </ItemGroup>

        <Copy
                SourceFiles="@(BuildFiles)"
                DestinationFolder="$([System.IO.Path]::Combine('$(GameDirectory)', 'mods', '$(GameOutputDirectory)', '%(RecursiveDir)'))"/>
    </Target>

</Project>